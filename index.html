<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Radar AÃ©reo</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map { height: 100vh; }
    .popup-img { width: 200px; }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const hexCodes = ["407CAF", "3C6B82", "4CA77E"]; // Exemplo

    const map = L.map('map').setView([38.736946, -9.142685], 6); // Lisboa
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    hexCodes.forEach(async hex => {
      try {
        const [hexdbRes, adsbRes] = await Promise.all([
          fetch(`https://hexdb.io/api/v1/aircraft/${hex}`).then(r => r.json()),
          fetch(`https://api.adsbdb.com/v0/aircraft/${hex}`).then(r => r.json())
        ]);

        if (!adsbRes.lat || !adsbRes.lon) return;

        const marker = L.marker([adsbRes.lat, adsbRes.lon]).addTo(map);
        const popupContent = `
          <strong>${hexdbRes.operator || 'Desconhecido'}</strong><br>
          Tipo: ${hexdbRes.type || 'N/A'}<br>
          Registo: ${hexdbRes.registration || 'N/A'}<br>
          Altitude: ${adsbRes.altitude} ft<br>
          Velocidade: ${adsbRes.speed} kt<br>
          <img src="${hexdbRes.image}" class="popup-img" />
        `;
        marker.bindPopup(popupContent);
      } catch (err) {
        console.error(`Erro ao buscar dados para ${hex}:`, err);
      }
    });
  </script>
</body>
</html>